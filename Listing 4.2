import numpy as np
import matplotlib.pyplot as plt

# Listing 4.2 Example of a numerical convolution
Ts = 1/100
time = 10
t = np.arange(0,time,Ts)
h = np.exp(-t) # define impulse response
x = np.zeros(np.size(t)) # input = sum of two delta functions
x[int(1/Ts)-1] = 3 # at times t = 1 and t = 3
x[int(3/Ts)-1] = 2
y = np.convolve(h,x)
fig, (ax1, ax2, ax3) = plt.subplots(3)
ax1.plot(t, x)
ax1.set_ylabel('Input')
ax2.plot(t, h)
ax2.set_ylabel('Impulse response')
ax3.plot(t,y[np.arange(0,len(t),1)])
ax3.set_ylabel('Output')
ax3.set_xlabel('Time in seconds')
plt.show()
